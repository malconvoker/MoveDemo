{
	"name": "Game",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "Global"
		},
		{
			"eventType": "include",
			"includeSheet": "Player"
		},
		{
			"eventType": "include",
			"includeSheet": "Enemies"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "every-tick",
					"objectClass": "System",
					"sid": 648030917696883
				}
			],
			"actions": [
				{
					"id": "set-position",
					"objectClass": "PlayerMask",
					"sid": 294320367016499,
					"parameters": {
						"x": "PlayerBase.ImagePointX(\"center\")",
						"y": "PlayerBase.ImagePointY(\"center\")"
					}
				},
				{
					"id": "set-position",
					"objectClass": "CursorTest",
					"sid": 319344139592282,
					"disabled": true,
					"parameters": {
						"x": "floor(Touch.X/40)*40",
						"y": "floor(Touch.Y/40)*40"
					}
				},
				{
					"id": "set-text",
					"objectClass": "TXTcursorangle",
					"sid": 695667475164690,
					"disabled": true,
					"parameters": {
						"text": "Functions.GetTouchAngle"
					}
				},
				{
					"id": "set-text",
					"objectClass": "TXTcursorangle",
					"sid": 592333950038527,
					"parameters": {
						"text": "\"Touch \" & Functions.GetTouchAngle & \"°, Move \" & PlayerBase.MoveAngle & \"°\""
					}
				},
				{
					"id": "set-text",
					"objectClass": "TXTturn",
					"sid": 188704215639888,
					"disabled": true,
					"parameters": {
						"text": "\"Turn \" & Turn"
					}
				},
				{
					"callFunction": "DisplayEnemyData",
					"sid": 260108914131132
				},
				{
					"id": "set-text",
					"objectClass": "TXThp",
					"sid": 346023567101003,
					"parameters": {
						"text": "PlayerBase.hp & \"/\" & PlayerBase.maxhp & \"hp\""
					}
				}
			],
			"sid": 360115802153197,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-on-screen",
							"objectClass": "CursorTest",
							"sid": 784163220509569
						}
					],
					"actions": [
						{
							"id": "set-angle",
							"objectClass": "CollisionSprite",
							"sid": 115464768060586,
							"parameters": {
								"angle": "Functions.CursorDistance"
							}
						}
					],
					"sid": 612696239599481
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-tap",
					"objectClass": "Touch",
					"sid": 494671987899036
				},
				{
					"id": "is-touching-object",
					"objectClass": "Touch",
					"sid": 359183546486801,
					"parameters": {
						"object": "PlayerBase"
					},
					"isInverted": true
				}
			],
			"actions": [
				{
					"callFunction": "MovePlayerOneTile",
					"sid": 100972525731210,
					"parameters": [
						"Functions.GetTouchAngle"
					]
				}
			],
			"sid": 709071197982382,
			"disabled": true
		},
		{
			"functionName": "MovePlayerOneTile",
			"functionDescription": "Move PlayerBase to correct tile based on angle (0-360)",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "moveAngle",
					"type": "number",
					"initialValue": "0",
					"comment": "Angle of movement",
					"sid": 328507846548003
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 275279284490143,
					"parameters": {
						"instance-variable": "MoveAngle",
						"value": "moveAngle"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 854337544910664,
					"parameters": {
						"instance-variable": "MoveX",
						"value": "0"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 770764778146551,
					"parameters": {
						"instance-variable": "MoveY",
						"value": "0"
					}
				}
			],
			"sid": 339589779955344,
			"disabled": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 837947077006302,
							"parameters": {
								"first-value": "abs(PlayerBase.MoveAngle)",
								"comparison": 3,
								"second-value": "45"
							}
						},
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 810798492293179,
							"parameters": {
								"first-value": "abs(PlayerBase.MoveAngle)",
								"comparison": 5,
								"second-value": "315"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 225228227506842,
							"parameters": {
								"instance-variable": "MoveX",
								"value": "Tile"
							}
						}
					],
					"sid": 421688721406560,
					"disabled": true,
					"isOrBlock": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 522662724709795,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "45",
								"upper-bound": "135"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 495203786705672,
							"parameters": {
								"instance-variable": "MoveY",
								"value": "Tile"
							}
						}
					],
					"sid": 486342918509024,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 969520471534766,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "135",
								"upper-bound": "225"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 664626713785256,
							"parameters": {
								"instance-variable": "MoveX",
								"value": "-Tile"
							}
						}
					],
					"sid": 684058582234536,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 810121991545435,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "225",
								"upper-bound": "315"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 817927228460470,
							"parameters": {
								"instance-variable": "MoveY",
								"value": "-Tile"
							}
						}
					],
					"sid": 339112512791130,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "PlayerBase",
							"sid": 541762153048028,
							"parameters": {
								"x": "PlayerBase.X + PlayerBase.MoveX",
								"y": "PlayerBase.Y + PlayerBase.MoveY"
							}
						},
						{
							"id": "set-text",
							"objectClass": "TXTmovedistance",
							"sid": 354059620272526,
							"parameters": {
								"text": "\"Move: \" & PlayerBase.MoveX & \", \" & PlayerBase.MoveY"
							}
						}
					],
					"sid": 865315964994295,
					"disabled": true
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "compare-instance-variable",
					"objectClass": "PlayerBase",
					"sid": 276104219359694,
					"parameters": {
						"instance-variable": "MoveX",
						"comparison": 1,
						"value": "0"
					}
				}
			],
			"actions": [
				{
					"id": "set-x",
					"objectClass": "PlayerBase",
					"sid": 368943917501179,
					"parameters": {
						"x": "PlayerBase.X+PlayerBase.MoveX"
					}
				}
			],
			"sid": 919454543834805,
			"disabled": true
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "compare-instance-variable",
					"objectClass": "PlayerBase",
					"sid": 799654694997607,
					"parameters": {
						"instance-variable": "MoveY",
						"comparison": 1,
						"value": "0"
					}
				}
			],
			"actions": [
				{
					"id": "set-x",
					"objectClass": "PlayerBase",
					"sid": 855495656416696,
					"parameters": {
						"x": "PlayerBase.Y+PlayerBase.MoveY"
					}
				}
			],
			"sid": 798624544011025,
			"disabled": true
		},
		{
			"eventType": "comment",
			"text": "Display Player Pathfinding"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-path-found",
					"objectClass": "PlayerBase",
					"sid": 512803503606143,
					"behaviorType": "Pathfinding"
				}
			],
			"actions": [
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 672620521969275,
					"parameters": {
						"object-to-create": "Node",
						"layer": "\"Layer 0\"",
						"x": "PlayerBase.ImagePointX(\"center\")",
						"y": "PlayerBase.ImagePointY(\"center\")"
					}
				},
				{
					"id": "set-angle-toward-position",
					"objectClass": "Node",
					"sid": 885811489412841,
					"parameters": {
						"x": "PlayerBase.Pathfinding.NodeXAt(0)",
						"y": "PlayerBase.Pathfinding.NodeYAt(0)"
					}
				},
				{
					"id": "set-angle",
					"objectClass": "Node",
					"sid": 711421660772931,
					"parameters": {
						"angle": "round(Self.Angle/45)*45"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 386311849953547,
					"parameters": {
						"instance-variable": "MoveAngle",
						"value": "Node.Angle"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 852869933473029,
					"parameters": {
						"instance-variable": "MoveX",
						"value": "0"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 357028234564924,
					"parameters": {
						"instance-variable": "MoveY",
						"value": "0"
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 276701768542860,
					"parameters": {
						"object-to-create": "PfPing",
						"layer": "\"Layer 0\"",
						"x": "PlayerBase.Pathfinding.NodeXAt(PlayerBase.Pathfinding.NodeCount-1)",
						"y": "PlayerBase.Pathfinding.NodeYAt(PlayerBase.Pathfinding.NodeCount-1)"
					}
				}
			],
			"sid": 447887303418001,
			"disabled": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 630016224710398,
							"parameters": {
								"first-value": "abs(PlayerBase.MoveAngle)",
								"comparison": 3,
								"second-value": "45"
							}
						},
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 305968984398831,
							"parameters": {
								"first-value": "abs(PlayerBase.MoveAngle)",
								"comparison": 5,
								"second-value": "315"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 514255062052319,
							"parameters": {
								"instance-variable": "MoveX",
								"value": "Tile"
							}
						}
					],
					"sid": 663303559204714,
					"disabled": true,
					"isOrBlock": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 217063052560116,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "45",
								"upper-bound": "135"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 696690487626369,
							"parameters": {
								"instance-variable": "MoveY",
								"value": "Tile"
							}
						}
					],
					"sid": 237603628780934,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 592056988382747,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "135",
								"upper-bound": "225"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 343293854349460,
							"parameters": {
								"instance-variable": "MoveX",
								"value": "-Tile"
							}
						}
					],
					"sid": 489215945725459,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-between-values",
							"objectClass": "System",
							"sid": 100712112635223,
							"parameters": {
								"value": "PlayerBase.MoveAngle",
								"lower-bound": "225",
								"upper-bound": "315"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "PlayerBase",
							"sid": 936362262479549,
							"parameters": {
								"instance-variable": "MoveY",
								"value": "-Tile"
							}
						}
					],
					"sid": 935729709613697,
					"disabled": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-tile-at",
							"objectClass": "Collisions",
							"sid": 475446385180052,
							"parameters": {
								"tile-x": "CursorTest.X/Tile",
								"tile-y": "CursorTest.Y/Tile",
								"comparison": 1,
								"tile": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "TXTmovedistance",
							"sid": 965699643504224,
							"parameters": {
								"text": "\"Move: \" & PlayerBase.MoveX & \", \" & PlayerBase.MoveY"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 647231289517657,
							"parameters": {
								"object-to-create": "OldMoveTile",
								"layer": "0",
								"x": "PlayerBase.X+PlayerBase.MoveX",
								"y": "PlayerBase.Y+PlayerBase.MoveY"
							}
						}
					],
					"sid": 165160204067175,
					"disabled": true
				},
				{
					"eventType": "comment",
					"text": "Copied from pathfinding example"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "repeat",
							"objectClass": "System",
							"sid": 139449800388704,
							"parameters": {
								"count": "PlayerBase.Pathfinding.NodeCount"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 563101274831598,
							"parameters": {
								"object-to-create": "Node",
								"layer": "\"Layer 0\"",
								"x": "PlayerBase.Pathfinding.NodeXAt(loopindex)",
								"y": "PlayerBase.Pathfinding.NodeYAt(loopindex)"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 661852967242011,
							"parameters": {
								"object-to-create": "OldMoveTile",
								"layer": "\"Layer 0\"",
								"x": "floor(PlayerBase.Pathfinding.NodeXAt(loopindex)/Tile)*Tile",
								"y": "floor(PlayerBase.Pathfinding.NodeYAt(loopindex)/Tile)*Tile"
							}
						}
					],
					"sid": 446868255458504,
					"children": [
						{
							"eventType": "comment",
							"text": "If it's the last node, change the animation frame to show it's the end."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 498700542391882,
									"parameters": {
										"first-value": "LoopIndex",
										"comparison": 0,
										"second-value": "PlayerBase.Pathfinding.NodeCount - 1"
									}
								}
							],
							"actions": [
								{
									"id": "set-animation-frame",
									"objectClass": "Node",
									"sid": 678792043586090,
									"parameters": {
										"frame-number": "1"
									}
								}
							],
							"sid": 203779515300275
						},
						{
							"eventType": "comment",
							"text": "Otherwise point it to the next node."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 804052200883678
								}
							],
							"actions": [
								{
									"id": "set-angle-toward-position",
									"objectClass": "Node",
									"sid": 581212344017724,
									"parameters": {
										"x": "PlayerBase.Pathfinding.NodeXAt(loopindex + 1)",
										"y": "PlayerBase.Pathfinding.NodeYAt(loopindex + 1)"
									}
								}
							],
							"sid": 149017256306654
						}
					]
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-failed-to-find-path",
					"objectClass": "PlayerBase",
					"sid": 456899708941347,
					"behaviorType": "Pathfinding"
				}
			],
			"actions": [
				{
					"id": "flash",
					"objectClass": "PlayerMask",
					"sid": 363513301653848,
					"behaviorType": "Flash",
					"parameters": {
						"on-time": "0.1",
						"off-time": "0.1",
						"duration": "0.5"
					}
				}
			],
			"sid": 362867716457436
		},
		{
			"eventType": "comment",
			"text": "Display Enemy Pathfinding"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-path-found",
					"objectClass": "EnemyBases",
					"sid": 796391311704224,
					"behaviorType": "Pathfinding"
				}
			],
			"actions": [
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 818290965999106,
					"parameters": {
						"object-to-create": "Node",
						"layer": "\"Layer 0\"",
						"x": "EnemyBases.ImagePointX(\"center\")",
						"y": "EnemyBases.ImagePointY(\"center\")"
					}
				},
				{
					"id": "set-angle-toward-position",
					"objectClass": "Node",
					"sid": 489058656965495,
					"parameters": {
						"x": "EnemyBases.Pathfinding.NodeXAt(0)",
						"y": "EnemyBases.Pathfinding.NodeYAt(0)"
					}
				},
				{
					"id": "set-angle",
					"objectClass": "Node",
					"sid": 613950202593080,
					"disabled": true,
					"parameters": {
						"angle": "round(Self.Angle/45)*45"
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 333330202726550,
					"parameters": {
						"object-to-create": "PfPing",
						"layer": "\"Layer 0\"",
						"x": "EnemyBases.Pathfinding.NodeXAt(EnemyBases.Pathfinding.NodeCount-1)",
						"y": "EnemyBases.Pathfinding.NodeYAt(EnemyBases.Pathfinding.NodeCount-1)"
					}
				}
			],
			"sid": 305286356991018,
			"disabled": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Copied from pathfinding example"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "repeat",
							"objectClass": "System",
							"sid": 663715068289952,
							"parameters": {
								"count": "EnemyBases.Pathfinding.NodeCount"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 122380296249581,
							"parameters": {
								"object-to-create": "Node",
								"layer": "\"Layer 0\"",
								"x": "EnemyBases.Pathfinding.NodeXAt(loopindex)",
								"y": "EnemyBases.Pathfinding.NodeYAt(loopindex)"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 352423310684150,
							"disabled": true,
							"parameters": {
								"object-to-create": "OldMoveTile",
								"layer": "\"Layer 0\"",
								"x": "floor(EnemyBases.Pathfinding.NodeXAt(loopindex)/Tile)*Tile",
								"y": "floor(EnemyBases.Pathfinding.NodeYAt(loopindex)/Tile)*Tile"
							}
						}
					],
					"sid": 965077836037044,
					"disabled": true,
					"children": [
						{
							"eventType": "comment",
							"text": "If it's the last node, change the animation frame to show it's the end."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 118668129619997,
									"parameters": {
										"first-value": "LoopIndex",
										"comparison": 0,
										"second-value": "EnemyBases.Pathfinding.NodeCount - 1"
									}
								}
							],
							"actions": [
								{
									"id": "set-animation-frame",
									"objectClass": "Node",
									"sid": 570565884004388,
									"parameters": {
										"frame-number": "1"
									}
								}
							],
							"sid": 827207354109972,
							"disabled": true
						},
						{
							"eventType": "comment",
							"text": "Otherwise point it to the next node."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 795039938214678
								}
							],
							"actions": [
								{
									"id": "set-angle-toward-position",
									"objectClass": "Node",
									"sid": 437944077758098,
									"parameters": {
										"x": "EnemyBases.Pathfinding.NodeXAt(loopindex + 1)",
										"y": "EnemyBases.Pathfinding.NodeYAt(loopindex + 1)"
									}
								}
							],
							"sid": 188439158870100,
							"disabled": true
						}
					]
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-failed-to-find-path",
					"objectClass": "EnemyBases",
					"sid": 967205817565553,
					"behaviorType": "Pathfinding"
				}
			],
			"actions": [
				{
					"id": "flash",
					"objectClass": "EnemyMasks",
					"sid": 617587230638208,
					"behaviorType": "Flash",
					"parameters": {
						"on-time": "0.1",
						"off-time": "0.1",
						"duration": "0.5"
					}
				}
			],
			"sid": 822693925488589
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-any-animation-finished",
					"objectClass": "PfPing",
					"sid": 960075455258641
				}
			],
			"actions": [
				{
					"id": "destroy",
					"objectClass": "PfPing",
					"sid": 454932853218918
				}
			],
			"sid": 993377163552749
		}
	],
	"sid": 301707553409410
}